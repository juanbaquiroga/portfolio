import asyncio
from playwright.async_api import async_playwright, expect

async def main():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=True)
        page = await browser.new_page()

        # Go to login page
        await page.goto("http://localhost:3000/login")
        await page.screenshot(path="jules-scratch/verification/01_login_page.png")

        # Create admin user
        email = "admin@test.com"
        password = "password123"
        await page.get_by_placeholder("Email").fill(email)
        await page.get_by_placeholder("Password").fill(password)
        await page.get_by_role("button", name="Create Account").click()

        # Wait for navigation to admin page after login
        await page.wait_for_url("**/admin", timeout=30000)
        await expect(page.get_by_role("heading", name="Dashboard")).to_be_visible()
        await page.screenshot(path="jules-scratch/verification/02_admin_dashboard.png")

        # Navigate to Projects page
        await page.get_by_role("link", name="Projects").click()
        await expect(page.get_by_role("button", name="Create Project")).to_be_visible()
        await page.screenshot(path="jules-scratch/verification/03_projects_page.png")

        # Navigate to Technologies page
        await page.get_by_role("link", name="Technologies").click()
        await expect(page.get_by_role("button", name="Create Technology")).to_be_visible()
        await page.screenshot(path="jules-scratch/verification/04_technologies_page.png")

        # Add a new technology for the project form
        await page.get_by_placeholder("Title").fill("React")
        await page.get_by_placeholder("Documentation Link").fill("https://react.dev")
        await page.get_by_placeholder("Color (e.g. #FFFFFF)").fill("#61DAFB")
        await page.get_by_placeholder("Paste full SVG code here").fill('<svg viewBox="0 0 1139 1024" xmlns="http://www.w3.org/2000/svg"><path d="M640 997.333c-3.2 0-6.4-0.533-9.6-1.067-1.6-0.533-3.2-1.067-4.8-1.6-4.8-1.6-9.6-3.733-14.4-5.867-27.733-14.4-52.267-36.8-71.467-64.533-19.2-28.267-32-60.8-35.2-96-3.733-35.2-0.533-70.933 8-104.533 8.533-33.6 24-64.533 44.8-91.2 21.333-26.667 48-48 78.4-61.867 30.4-13.867 64-20.8 98.667-20.267 34.667 0.533 68.267 8 98.133 21.333 29.867 13.333 56 32.533 76.267 55.467 20.267 22.933 34.133 49.6 40.533 78.4 6.4 28.8 5.333 58.667-2.133 87.467-7.467 28.8-22.4 55.467-42.667 77.333-20.267 21.867-45.867 39.467-74.667 51.2-28.8 11.733-60.8 17.067-92.8 15.467-3.2 0-6.4-0.533-9.067-0.533-1.067 0-2.133 0-3.2 0z m-56.533-162.133c-1.6-1.067-2.133-3.2-2.133-5.333 0-1.6 0.533-3.2 1.067-4.8 1.067-1.6 2.667-2.667 4.267-3.733 1.6-1.067 3.2-2.133 5.333-2.667 2.133-0.533 4.267-1.067 6.4-1.067 1.6 0 3.2 0 4.8 0.533 33.067 1.6 65.067-3.733 94.4-15.467 29.333-11.733 54.933-29.333 74.667-51.2 20.267-21.867 34.667-47.467 41.6-75.2 6.933-27.733 8-56.533 2.133-84.267-5.867-27.733-19.2-53.333-38.4-75.2-19.2-21.867-44.267-39.467-72.533-51.733-28.267-12.267-59.733-18.667-91.2-18.667-31.467 0-62.933 6.4-91.2 18.133-30.4 12.8-56.533 32.533-76.267 57.067-20.267 24.533-34.133 53.867-40.533 85.333-6.4 31.467-5.333 64 2.133 94.4 7.467 30.4 22.4 58.133 42.667 81.067 20.267 22.933 45.867 41.067 74.667 52.8 2.133 1.067 4.267 1.6 6.4 2.133 2.133 0.533 3.733 1.067 5.333 1.6 1.6 0.533 3.2 1.067 4.267 1.6 1.6 1.067 2.667 2.133 3.733 3.733 1.067 1.6 1.6 3.2 1.6 4.8 0 2.133-0.533 4.267-2.133 5.333-1.067 1.067-2.667 2.133-4.267 2.667-1.6 0.533-3.2 1.067-5.333 1.6-2.133 0.533-4.267 0.533-6.4 1.067-29.867 12.267-62.4 18.133-94.933 17.067-32.533-1.067-64-8.533-92.267-21.867-28.267-13.333-53.333-32.533-73.067-55.467-19.733-22.933-34.133-50.133-41.6-79.467-7.467-29.333-8-60.8-1.067-91.2 6.933-30.4 20.8-59.2 39.467-84.267 18.667-25.067 42.667-45.867 70.4-61.333 27.733-15.467 58.667-25.067 91.2-27.2 32.533-2.133 65.067 2.667 94.933 13.333 29.867 10.667 57.067 27.733 79.467 49.6 22.4 21.867 39.467 48 49.6 76.8 10.133 28.8 13.333 59.733 9.6 89.6-3.733 29.867-14.4 58.133-31.467 82.133-17.067 24-39.467 43.2-65.067 56-25.6 12.8-54.4 18.667-83.2 17.067-2.667 0-5.333-0.533-8-0.533s-5.333 0-8 0z m-26.667-558.933c-1.6-1.067-3.2-1.6-5.333-2.133-2.133-0.533-4.267-1.067-6.4-1.067-1.6 0-3.2 0-4.8 0.533-33.067 1.6-65.067-3.733-94.4-15.467-29.333-11.733-54.933-29.333-74.667-51.2-20.267-21.867-34.667-47.467-41.6-75.2-6.933-27.733-8-56.533-2.133-84.267 5.867-27.733 19.2-53.333 38.4-75.2 19.2-21.867 44.267-39.467 72.533-51.733 28.267-12.267 59.733-18.667 91.2-18.667 31.467 0 62.933 6.4 91.2 18.133 30.4 12.8 56.533 32.533 76.267 57.067 20.267 24.533 34.133 53.867 40.533 85.333 6.4 31.467 5.333 64-2.133 94.4-7.467 30.4-22.4 58.133-42.667 81.067-20.267 22.933-45.867 41.067-74.667 52.8-2.133 1.067-4.267 1.6-6.4 2.133-2.133 0.533-3.733 1.067-5.333 1.6-1.6 0.533-3.2 1.067-4.267 1.6-1.6 1.067-2.667 2.133-3.733 3.733-1.067 1.6-1.6 3.2-1.6 4.8 0 2.133 0.533 4.267 2.133 5.333 1.067 1.067 2.667 2.133 4.267 2.667 1.6 0.533 3.2 1.067 5.333 1.6 2.133 0.533 4.267 0.533 6.4 1.067 29.867 12.267 62.4 18.133 94.933 17.067 32.533-1.067 64-8.533 92.267-21.867 28.267-13.333 53.333-32.533 73.067-55.467 19.733-22.933 34.133-50.133 41.6-79.467 7.467-29.333 8-60.8-1.067-91.2-6.933-30.4-20.8-59.2-39.467-84.267-18.667-25.067-42.667-45.867-70.4-61.333-27.733-15.467-58.667-25.067-91.2-27.2-32.533-2.133-65.067 2.667-94.933 13.333-29.867 10.667-57.067 27.733-79.467 49.6-22.4 21.867-39.467 48-49.6 76.8-10.133 28.8-13.333 59.733-9.6 89.6 3.733 29.867 14.4 58.133 31.467 82.133 17.067 24 39.467 43.2 65.067 56 25.6 12.8 54.4 18.667 83.2 17.067 2.667 0 5.333-0.533 8-0.533s5.333 0 8 0c1.6 0 2.667-0.533 4.267-1.067 1.6-0.533 2.667-1.067 3.733-2.133 1.067-1.067 1.6-2.133 2.133-3.733 0.533-1.6 0.533-3.2 0.533-4.8 0-2.133-0.533-3.733-1.6-5.333-1.067-1.067-2.133-2.133-3.733-2.667z M512 512c0 29.867-4.267 59.733-12.8 88.533-8.533 28.8-20.8 56-36.8 80.533-16 24.533-35.2 46.4-57.6 64-22.4 17.6-47.467 31.467-74.667 40.533-27.2 9.067-56.533 13.333-85.333 12.8-28.8-0.533-57.6-5.867-84.267-16-26.667-10.133-51.2-25.067-72.533-43.2-21.333-18.133-39.467-39.467-52.8-62.933-13.333-23.467-21.333-48.533-24.533-74.667-3.2-26.133-1.067-52.267 6.4-77.333 7.467-25.067 19.2-48.533 34.133-69.333 14.933-20.8 32.533-38.933 52.8-53.333 20.267-14.4 42.667-24.533 66.133-30.4 23.467-5.867 48-7.467 71.467-4.267 23.467 3.2 46.4 11.2 67.2 23.467 20.8 12.267 39.467 28.267 54.4 46.933 14.933 18.667 26.133 39.467 33.067 61.333 6.933 21.867 9.6 44.267 7.467 66.133-2.133 21.867-8.533 43.2-19.2 62.933-10.667 19.733-25.067 37.333-42.667 51.733-17.6 14.4-37.867 25.067-59.733 31.467-2.133 0.533-3.733 1.067-5.333 1.6-1.6 0.533-3.2 1.067-4.267 1.6-1.6 1.067-2.667 2.133-3.733 3.733-1.067 1.6-1.6 3.2-1.6 4.8 0 2.133 0.533 4.267 2.133 5.333 1.067 1.067 2.667 2.133 4.267 2.667 1.6 0.533 3.2 1.067 5.333 1.6 2.133 0.533 4.267 0.533 6.4 1.067 22.933 6.4 46.933 9.067 70.4 7.467 23.467-1.6 46.4-7.467 67.2-17.067 20.8-9.6 39.467-23.467 54.933-40.533 15.467-17.067 27.2-37.333 34.667-59.733 7.467-22.4 10.133-46.4 8-69.333-2.133-22.933-8.533-44.8-18.667-64.533-10.133-19.733-24-37.333-40.533-51.733s-35.2-25.6-55.467-32.533c-20.267-6.933-41.6-9.6-62.933-7.467-21.333 2.133-42.133 8.533-60.8 18.667-18.667 10.133-35.2 24-48.533 40.533-13.333 16.533-22.933 35.2-28.267 55.467-5.333 20.267-6.4 41.6-2.667 62.4 3.733 20.8 11.733 40.533 23.467 58.133 11.733 17.6 26.667 32.533 44.267 43.733 17.6 11.2 37.333 18.667 58.133 21.867 2.667 0.533 5.333 0.533 8 1.067 2.667 0 5.333 0 8 0z" fill="#61DAFB"/></svg>')
        await page.get_by_role("button", name="Create Technology").click()
        await expect(page.get_by_text("React")).to_be_visible()

        # Navigate to Projects page again to use the new technology
        await page.get_by_role("link", name="Projects").click()
        await expect(page.get_by_role("button", name="Create Project")).to_be_visible()

        # Create a project
        await page.get_by_placeholder("Title").fill("My First Project")
        await page.get_by_placeholder("Description (EN)").fill("This is a test project.")
        await page.get_by_placeholder("Description (ES)").fill("Este es un proyecto de prueba.")
        await page.locator('input[type="file"]').first().set_input_files('public/favicon.ico')
        await page.locator('input[type="file"]').last().set_input_files('public/favicon.ico')
        await page.get_by_label("React").check()
        await page.get_by_role("button", name="Create Project").click()

        await page.wait_for_url("**/admin", timeout=30000)
        await page.screenshot(path="jules-scratch/verification/05_project_created.png")

        await browser.close()

if __name__ == "__main__":
    asyncio.run(main())